<html>
    <head>
        <title>Token Authentication</title>
    </head>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>    

    <script>
      async function signup(){
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            if (!username || !password) {
                alert("Please enter both username and password");
                return;
            }

            try {
                const response = await axios.post("http://localhost:3000/signup", {
                    username: username,
                    password: password
                });

                alert(response.data.message);
                // Clear the form
                document.getElementById("username").value = "";
                document.getElementById("password").value = "";
            } catch (error) {
                alert("Signup failed");
            }
        }

        async function signin(){
            const username = document.getElementById("username1").value;
            const password = document.getElementById("password1").value;

            if (!username || !password) {
                alert("Please enter both username and password");
                return;
            }

            try {
                const response = await axios.post("http://localhost:3000/signin", {
                    username: username,
                    password: password
                });

                localStorage.setItem("token", response.data.token);
                alert("User signed in successfully");
                
                // Clear the form
                document.getElementById("username1").value = "";
                document.getElementById("password1").value = "";
            } catch (error) {
                alert("Login failed");
            }
        }

        function getUserInfo(){
            const token = localStorage.getItem("token");
            
            if (!token) {
                alert("Please login first!");
                return;
            }
            
            // Redirect to the me page
            window.location.href = "/me.html";
        }
           
        function logout(){
            localStorage.removeItem("token");
            alert("Logged out successfully!");
        }
    </script>

    <body>
        <h1>Token Authentication</h1>

        <h2>Sign Up</h2>
        <input type="text" placeholder="Enter username" id="username"/>
        <input type="password" placeholder="Enter password" id="password"/>
        <button onclick="signup()">Sign Up</button>

        <br><br>

        <h2>Sign In</h2>
        <input type="text" placeholder="Enter username" id="username1"/>
        <input type="password" placeholder="Enter password" id="password1"/>
        <button onclick="signin()">Sign In</button>

        <br><br>

        <h3>Actions:</h3>
        <button onclick="getUserInfo()">Get My Info</button>
        <button onclick="logout()">Log Out</button>

    </body>
</html>
